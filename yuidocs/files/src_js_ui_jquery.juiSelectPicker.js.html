<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\js\ui\jquery.juiSelectPicker.js - jui-commons</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="jui-commons"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.49</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/jquery.juiSelectPicker.html">jquery.juiSelectPicker</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/$.jui.juiScrollableDropdown.html">$.jui.juiScrollableDropdown</a></li>
            
                <li><a href="../modules/$.jui.juiScrollPane.html">$.jui.juiScrollPane</a></li>
            
                <li><a href="../modules/$.jui.juiSplitText.html">$.jui.juiSplitText</a></li>
            
                <li><a href="../modules/jQuery.jui.juiBase.html">jQuery.jui.juiBase</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src\js\ui\jquery.juiSelectPicker.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Created by ElyDeLaCruz on 10/1/13.
 *
 * Hides a Select Element and Replaces it with a scrollable Select Picker element
 * which is fully stylable.
 *
 * @class jquery.juiSelectPicker
 * @constructor
 *
 * @requires jquery
 * @requires jquery.ui (core)
 * @requires jquery.ui.widget
 * @requires jquery.juiScrollableDropdown
 *
 * @todo convert all inline option docs to options doclet using the @ property tag
 *
 */
$.widget(&#x27;jui.juiSelectPicker&#x27;, $.jui.juiBase, {

    /**
     * Options hash.
     * @type {Object}
     * @attribute className {String}
     * @property animation {Object}
     * @property labelText {String}
     */
    options: {

        /**
         * Class name added to wrapper element.
         * @type {String} default: &#x27;jui-select-picker&#x27;;
         */
        className: &#x27;jui-select-picker&#x27;,

        /**
         * Animation options.
         * @type {Object}
         */
        animation: {
            duration: 0.30
        },

        /**
         * Label text.
         * @type {String}
         */
        labelText: &#x27;&#x27;,

        /**
         * Selected Value Label Prefix.
         * @type {String}
         */
        selectedLabelPrefix: &#x27;&#x27;,

        /**
         * Selected Value Label Suffix.
         * @type {String}
         */
        selectedLabelSuffix: &#x27;&#x27;,

        /**
         * Flag for using selected value label suffix and prefix.
         * @type {String}
         */
        useSelectedLabelPrefixAndSuffix: false,

        /**
         * Skip the first option from the select element in rendering to wrapper.
         * @type {Boolean}
         */
        skipFirstOptionItem: false,

        /**
         * Selected Value.
         * @type {mixed|null}
         */
        selectedValue: null,

        /**
         * Flag for disabling this plugin on touch devices (and using devices default).
         * @type {Boolean}
         */
        disableOnTouchDevice: true,

        /**
         * Ui Hash.
         * @type {Object}
         */
        ui: {
            wrapperElm: {
                elm: null,
                attribs: {
                    &#x27;class&#x27;: &#x27;jui-select-picker&#x27;
                },
                appendTo: &quot;after this.element&quot;,
                selector: &#x27;.jui-select-picker&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                create: true,
                timeline: new TimelineMax()
            },
            buttonElm: {
                elm: null,
                attribs: {
                    &#x27;class&#x27;: &#x27;button&#x27;
                },
                selector: &#x27;&gt; .button&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                appendTo: &#x27;wrapperElm&#x27;,
                create: true
            },
            buttonArrowElm: {
                elm: null,
                attribs: {
                    &#x27;class&#x27;: &#x27;arrow&#x27;
                },
                selector: &#x27;&gt; .arrow&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                appendTo: &#x27;buttonElm&#x27;,
                create: true
            },
            labelElm: {
                elm: null,
                attribs: {
                    &#x27;class&#x27;: &#x27;label&#x27;
                },
                text: &#x27;&#x27;,
                selector: &#x27;&gt; .label&#x27;,
                html: &#x27;&lt;span&gt;&lt;/span&gt;&#x27;,
                appendTo: &#x27;buttonElm&#x27;,
                create: true
            },
            selectedItemLabelElm: {
                elm: null,
                attribs: {
                    &#x27;class&#x27;: &#x27;selected-item-label selected&#x27;
                },
                prefixText: &#x27;You\&#x27;ve chosen &quot;&#x27;,
                suffixText: &#x27;&quot;&#x27;,
                selector: &#x27;&gt; .selected-item-label&#x27;,
                html: &#x27;&lt;span&gt;&lt;/span&gt;&#x27;,
                appendTo: &#x27;buttonElm&#x27;,
                create: true
            },
            bodyElm: {
                elm: null,
                attribs: {
                    &#x27;class&#x27;: &#x27;body&#x27;
                },
                selector: &#x27;&gt; .body&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                appendTo: &#x27;wrapperElm&#x27;,
                create: true
            },
            optionsElm: {
                elm: null,
                attribs: {
                    &#x27;class&#x27;: &#x27;options&#x27;
                },
                selector: &#x27;.options&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                appendTo: &#x27;bodyElm&#x27;,
                create: true,
                optionSelectedClassName: &#x27;selected&#x27;
            }
        }

    },

    /**
     * Sets flag if touch device (used for disable plugin if options.disableOnTouchDevice
     * is true).
     * @private
     */
    _create: function () {
        var ops = this.options;
        // If using modernizr and is touch enabled device, set flag
        if ($(&#x27;html&#x27;).hasClass(&#x27;touch&#x27;) &amp;&amp; ops.disableOnTouchDevice) {
            ops.isTouchDevice = true;
        }
    },

    /**
     * Initializes the select picker:
     * - Hides select element plugin was called on;
     * - Adds css classes for wrapper;
     * - Sets initial label text;
     * - Draws options within wrapper;
     * - Initializes scrollable drop down on wrapper;
     * - and Adds event listeners;
     * @private
     */
    _init: function () {
        var self = this,
            ops = this.options,
            className = self.getValueFromHash(&#x27;className&#x27;, ops),
            currentClassName =
                self.getValueFromHash(&#x27;ui.wrapperElm.attribs&#x27;, ops)[&#x27;class&#x27;];

        // Resolve class name
        if (!empty(className)) {
            if (!empty(currentClassName)
                &amp;&amp; typeof currentClassName === &#x27;string&#x27;) {
                ops.ui.wrapperElm.attribs[&#x27;class&#x27;] += &#x27; &#x27; + className;
            }
            else {
                ops.ui.wrapperElm.attribs[&#x27;class&#x27;] = className;
            }
        }

        // Timeline
        this.options.timeline = new TimelineMax({paused: true});

        // Hide this element and append new markup beside where it used
        // to be
        this.element.attr(&#x27;hidden&#x27;, &#x27;hidden&#x27;).css(&#x27;display&#x27;, &#x27;none&#x27;);

        // Populate ui elements on this (this.options.ui[elmKeyAlias])
        this._populateUiElementsFromOptions();

        // Set button text/label
        this.setLabelText();

        // Draw select options from this element onto our element
        this._drawSelectOptions();

        // Scrollable Drop Down
        this._initScrollableDropDown();

        // Listeners
        this._addEventListeners();
    },

    /**
     * Draws select element&#x27;s options into wrapper.
     * @private
     */
    _drawSelectOptions: function () {
        var self = this,
            optionsElm = self.getUiElement(&#x27;optionsElm&#x27;),
            options = self.element.find(&#x27;option&#x27;),
            ul = $(&#x27;&lt;ul&gt;&lt;/ul&gt;&#x27;),
            ops = self.options;

        // Loop through option elements and copy them over to our
        // options container
        options.each(function (i, option) {
            // From dom element to jquery element
            option = $(option);

            // If button label is using first option from options list
            // Don&#x27;t redraw this first option
            if (i === 0 &amp;&amp; ops.skipFirstOptionItem) {
                return;
            }

            var value = option.attr(&#x27;value&#x27;),
                dataValue = option.attr(&#x27;data-value&#x27;),
                classValue = option.attr(&#x27;class&#x27;),
                liClassValue = &#x27;&#x27;;

            // Preselect item if necessary
            if (isset(ops.selectedValue) &amp;&amp;
                (ops.selectedValue === value || ops.selectedValue === dataValue)) {
                if (!empty(liClassValue)) {
                    if (liClassValue.length &gt; 0) {
                        liClassValue += &#x27; &#x27;;
                    }
                    liClassValue += ops.ui.optionsElm.optionSelectedClassName;
                }
                else {
                    liClassValue = ops.ui.optionsElm.optionSelectedClassName;
                }

                liClassValue = &#x27; class=&quot;&#x27; + liClassValue + &#x27;&quot;&#x27;;
            }

            // Resolve class attribute and data-value attribute
            classValue = !empty(classValue) ? &#x27;class=&quot;&#x27; + classValue + &#x27;&quot; &#x27; : &#x27;&#x27;;
            value = empty(value) ? (empty(dataValue) ?
                &#x27;&#x27; : &#x27;data-value=&quot;&#x27; + dataValue + &#x27;&quot; &#x27;) :
                &#x27; data-value=&quot;&#x27; + value + &#x27;&quot;&#x27;;

            // Build list element
            var li = $(&#x27;&lt;li&#x27; + liClassValue + &#x27;&gt;&lt;a &#x27; + classValue + &#x27;href=&quot;javascript: void(0);&quot;&#x27;
                + value + &#x27;&gt;&#x27; + option.text() + &#x27;&lt;/a&gt;&lt;/li&gt;&#x27;);

            // Add first class
            if (i === 0 &amp;&amp; !empty(ops.ui.buttonElm.text)) {
                li.addClass(&#x27;first&#x27;);
            }
            else if (i === 1 &amp;&amp; empty(ops.ui.buttonElm.text)) {
                li.addClass(&#x27;first&#x27;);
            }

            // Add last class
            if (i === options.length - 1) {
                li.addClass(&#x27;last&#x27;);
            }

            // Append option to unoredered list element
            ul.append(li);
        });

        // Append unordered list element
        optionsElm.append(ul);
    },

    /**
     * Adds event listeners for:
     * - wrapper - mouseup;
     * - wrapper - a[data-value] click;
     * - select element - change;
     * @private
     */
    _addEventListeners: function () {
        var self = this,
            ops = this.options,
            wrapperElm = self.getUiElement(&#x27;wrapperElm&#x27;);

        // Option/A-Tag click
        wrapperElm.on(&#x27;mouseup&#x27;, function () {
            var collapsed = wrapperElm
                .juiScrollableDropDown(&#x27;getState&#x27;)
                .indexOf(&#x27;collapsed&#x27;) &gt; -1 ? true : false;
            if (collapsed) {
                self.playAnimation();
            }
            else {
                self.reverseAnimation();
            }
        });

        wrapperElm.on(&#x27;click&#x27;, &#x27;a[data-value]&#x27;, function (e) {
//            e.stopPropagation();
            var elm = $(e.currentTarget);
            self.clearSelected();
            self.setSelected(elm);
            ops.timeline.reverse();
        });

        // On select element change set it&#x27;s selected item label text
        this.element.on(&#x27;change&#x27;, function (e) {
            var elm = $(this),
                val = elm.val();
            if (isset(val)) {
                self.setSelectedItemLabelText(val);
//                self.setSelected(self.getOptionElementByValue(val));
            }
        });
    },

    /**
     * Removes created options.
     * @private
     */
    _removeCreatedOptions: function () {
        this.getUiElement(&#x27;optionsElm&#x27;).find(&#x27;ul&#x27;).remove();
    },

    /**
     * Makes wrapper&#x27;s content scrollable.
     * - Calls jui.scrollableDropDown on wrapper;
     * @private
     */
    _initScrollableDropDown: function () {
        var self = this,
            ops = self.options,
            wrapperElm = self.getUiElement(&#x27;wrapperElm&#x27;),
            contentElm = self.getUiElement(&#x27;optionsElm&#x27;),
            duration = ops.animation.duration,
            scrollbarElm,
            timeline,
            dropDown, dropDownOptions;

        // Scrollable drop down options
        dropDownOptions = {
            state: &#x27;collapsed&#x27;,
            ui: {
                contentElm: {
                    elm: this.getUiElement(&#x27;optionsElm&#x27;),
                    attribs: ops.ui.optionsElm.attribs,
                    selector: ops.ui.optionsElm.selector + &#x27;&#x27;
                }
            }};

        // Set expands on event value
        if (isset(ops.expandOn)) {
            dropDownOptions.expandOn = ops.expandOn;
        }

        // Set collapses on event value
        if (isset(ops.collapseOn)) {
            dropDownOptions.collapseOn = ops.collapseOn;
        }

        // Apply scrollable drop down on wrapper element
        dropDown = wrapperElm.juiScrollableDropDown(dropDownOptions);

        // Get the dropdowns timeline
        timeline = dropDown.juiScrollableDropDown(&#x27;getAnimationTimeline&#x27;);
        timeline.seek(0);
        timeline.clear();
        timeline.pause();

        // Get scrollbar element
        scrollbarElm = $(&#x27;.vertical.scrollbar&#x27;, wrapperElm);

        // Supply new tweens
        [
            TweenLite.to(wrapperElm, duration, {height: wrapperElm.css(&#x27;max-height&#x27;)}),
            TweenLite.to(contentElm, duration, {height: contentElm.css(&#x27;max-height&#x27;), autoAlpha: 1, delay: -0.30}),
            TweenLite.to(scrollbarElm, duration, {autoAlpha: 1, delay: -0.20})
        ]
            .forEach(function (tween) {
                timeline.add(tween);
            });
    },

    /**
     * Destroys &#x60;this&#x60; instance.
     * - Shows hidden select element;
     * - Removes created options;
     * - and calls _super&#x27;s destroy method (to finish up the cleaning process);
     * @method destroy
     * @returns {void}
     */
    destroy: function () {
        this.element.removeAttr(&#x27;hidden&#x27;);
        this._removeCreatedOptions();
        this._super();
    },

    /**
     * Refreshes the currently drawn options.
     * - Sets selected value;
     * - removes options;
     * - recreates options;
     * - sets label text;
     * - triggers &#x60;change&#x60; event on this (select element);
     * @method refreshOptions
     * @returns {void}
     */
    refreshOptions: function () {
        this.options.selectedValue = this.getSelectedOptionValue();
        this._removeCreatedOptions();
        this._drawSelectOptions();
        this.setLabelText();
        this.element.trigger(&#x27;change&#x27;);
    },

    /**
     * Sets the select picker&#x27;s &#x60;selected item label&#x60;.
     * @param text {string} value to set to label; default &#x27;&#x27;
     * @param textType {string} (html|text) (proxy jquery&#x27;s text() and/or html() methods to set text).  Default &#x27;text&#x27;
     * @param usePrefixAndSuffix {boolean} Whether to use prefix and suffix for label text. Default false
     * @method setSelectedItemLabelText
     * @returns {void}
     */
    setSelectedItemLabelText: function (text, textType, usePrefixAndSuffix) {
        var ops = this.options,
            config = ops.ui.selectedItemLabelElm,
            elm = this.getUiElement(&#x27;selectedItemLabelElm&#x27;).eq(0),
            prefixText, suffixText;

        text = text || &#x27;&#x27;;
        textType = textType || &#x27;text&#x27;;
        usePrefixAndSuffix = isset(usePrefixAndSuffix)
            ? usePrefixAndSuffix : ops.useSelectedLabelPrefixAndSuffix;

        if (usePrefixAndSuffix) {
            prefixText = ops.selectedLabelPrefix || config.prefixText || &#x27;&#x27;;
            suffixText = ops.selectedLabelSuffix || config.suffixText || &#x27;&#x27;;
            text = prefixText + text + suffixText;
        }

        // @todo move this declaration to the add event listeners
        // function and optimize it
        TweenMax.to(elm, 0.16, {
            autoAlpha: 0,
            onCompleteParams: [text, textType, elm],
            onComplete: function () {
                var args = arguments,
                    text = args[0],
                    textType = args[1],
                    elm = args[2];
                elm[textType](text);
                TweenMax.to(elm, 0.16, {autoAlpha: 1});
            }});
    },

    /**
     * Sets the select picker&#x27;s label.
     * @param text {string} value to set on label;
     * @param textType {string} proxy key for jquery for setting text. Default &#x27;text&#x27;
     * @method setLabelText
     * @return {void}
     */
    setLabelText: function (text, textType) {
        textType = textType || &#x27;text&#x27;;
        text = text || (!empty(this.options.ui.buttonElm.text)
            ? this.options.ui.buttonElm.text
            : (!empty(this.options.labelText) ? this.options.labelText :
            this.element.find(&#x27;option&#x27;).eq(0).text()));
        this.getUiElement(&#x27;labelElm&#x27;).eq(0)[textType](text);
    },

    /**
     * Sets the selected element in the wrapper&#x27;s drawn options.
     * - Triggers a change event on this.element (select element);
     * @param elm {jquery} The actual element that should be selected.
     * @method setSelected
     * @return {void}
     */
    setSelected: function (elm) {
        if (elm.length === 0) {
            return;
        }
        elm.parent().addClass(
            this.options.ui.optionsElm.optionSelectedClassName);
        this.element.val(elm.attr(&#x27;data-value&#x27;)).trigger(&#x27;change&#x27;);
        this.options.selectedValue = elm.attr(&#x27;data-value&#x27;);
    },

    /**
     * Clears the currently selected element.
     * @method clearSelected
     * @returns {void}
     */
    clearSelected: function () {
        this.getUiElement(&#x27;optionsElm&#x27;)
            .find(&#x27;&gt; ul &gt; li&#x27;).removeClass(
                this.options.ui.optionsElm.optionSelectedClassName);
        this.options.selectedValue = null;
    },

    /**
     * Plays animation timeline (if disableOnTouchDevice is true and isTouchDevice, does nothing).
     * @method playAnimation
     * @return {void}
     */
    playAnimation: function () {
        var self = this,
            ops = self.options;
        if (ops.disableOnTouchDevice &amp;&amp; ops.isTouchDevice) {
            return;
        }
        ops.timeline.play();
    },

    /**
     * Reverses the animation timeline if not touch device.
     * @method reverseAnimation
     * @return {void}
     */
    reverseAnimation: function () {
        var self = this,
            ops = self.options;
        if (ops.disableOnTouchDevice &amp;&amp; ops.isTouchDevice) {
            return;
        }
        ops.timeline.reverse();
    },

    /**
     * Gets a drawn option element (from within wrapper) by value.
     * @method getOptionElementByValue
     * @param value
     */
    getOptionElementByValue: function (value) {
        this.getUiElement(&#x27;optionsElm&#x27;)
            .find(&#x27;[data-value=&quot;&#x27; + value +&#x27;&quot;]&#x27;);
    },

    /**
     * Gets the selected option&#x27;s value (from within wrapper).
     * @returns {*}
     */
    getSelectedOptionValue: function () {
        return this.getUiElement(&#x27;optionsElm&#x27;)
            .find(&#x27;.&#x27; + this.options.ui.optionsElm.optionSelectedClassName)
            .find(&#x27;a&#x27;).attr(&#x27;data-value&#x27;);
    }

});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
