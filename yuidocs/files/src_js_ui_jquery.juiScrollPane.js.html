<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\js\ui\jquery.juiScrollPane.js - jui-commons</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="jui-commons"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.49</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/jquery.juiSelectPicker.html">jquery.juiSelectPicker</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/$.jui.juiScrollableDropdown.html">$.jui.juiScrollableDropdown</a></li>
            
                <li><a href="../modules/$.jui.juiScrollPane.html">$.jui.juiScrollPane</a></li>
            
                <li><a href="../modules/$.jui.juiSplitText.html">$.jui.juiSplitText</a></li>
            
                <li><a href="../modules/jQuery.jui.juiBase.html">jQuery.jui.juiBase</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src\js\ui\jquery.juiScrollPane.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Makes a content area scrollable with custom
 * scrollbars whose elements are fetched or created depending on the
 * flags passed in/or-not-passed in by the user.
 *
 * @module $.jui.juiScrollPane
 *
 * @requires jquery.mousewheel (for crossbrowser mousewheel functionality)
 * @requires jquery
 * @requires jquery.ui (jquery ui core)
 * @requires jquery.ui.widget
 * @requires jquery.juiBase
 * @requires TweenMax
 * @returns jquery selection
 *
 * @author ElyDeLaCruz
 * @created 09/28/2013
 * @todo move event listeners out of the create function (for consistency)
 * @todo use the listeners added to window and contentHolder in the unbind function (to ensure we don&#x27;t remove anyone elses listeners)
 * @todo solve browser scrollbar mimicking
 */
$.widget(&#x27;jui.juiScrollPane&#x27;, $.jui.juiBase, {
    /**
     * Options Hash.
     * @type {Object}
     */
    options: {

        scrollSpeed: function () {
            var retVal = 0;
            retVal = this.getUiElement(&#x27;contentHolder&#x27;).height() / 3 / 3 * 2;
            return classOfIs(retVal, &#x27;Number&#x27;) ? retVal : 0;
        },

        // Left, up, right, down arrow keys and their direction values
        // to multiply the scrollspeed by
        keyPressHash: {
            &#x27;37&#x27;: -1,
            &#x27;38&#x27;: -1,
            &#x27;39&#x27;: 1,
            &#x27;40&#x27;: 1
        },

        // Continue scroll outer element after content holder has
        // reached it&#x27;s scroll end (either directions)
        mimickBrowser: false,

        ui: {
            contentHolder: {
                elm: null,
                selector: &#x27;&gt;.content&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                attribs: {
                    &#x27;class&#x27;: &#x27;content&#x27;
                }
            },
            vertScrollbar: {
                elm: null,
                selector: &#x27;&gt; .vertical.scrollbar&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                appendTo: &#x27;this.element&#x27;,
                attribs: {
                    &#x27;class&#x27;: &#x27;vertical scrollbar&#x27;
                },
                create: true
            },
            vertHandle: {
                elm: null,
                selector: &#x27;&gt; .handle&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                appendTo: &#x27;vertScrollbar&#x27;,
                attribs: {
                    &#x27;class&#x27;: &#x27;handle&#x27;
                },
                create: true
            },
            horizScrollbar: {
                elm: null,
                selector: &#x27;&gt; .horizontal.scrollbar&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                appendTo: &#x27;this.element&#x27;,
                attribs: {
                    &#x27;class&#x27;: &#x27;horizontal scrollbar&#x27;
                },
                create: true
            },
            horizHandle: {
                elm: null,
                selector: &#x27;&gt; .handle&#x27;,
                html: &#x27;&lt;div&gt;&lt;/div&gt;&#x27;,
                appendTo: &#x27;horizScrollbar&#x27;,
                attribs: {
                    &#x27;class&#x27;: &#x27;handle&#x27;
                },
                create: true
            }
        },

        pluginClassName: &#x27;jui-scroll-pane&#x27;,

        scrollbarOriented: {
            VERTICALLY: &#x27;vertical&#x27;,
            HORIZONTALLY: &#x27;horizontal&#x27;
        },

        autoHide: false,

        originalOverflow: null,

        debug: false
    },

    _create: function () {
        this._populateUiElementsFromOptions();
        var ops = this.options,
            contentHolder = this.getUiElement(&#x27;contentHolder&#x27;),
            contentScrollWidth = contentHolder.get(0).scrollWidth,
            contentScrollHeight = contentHolder.get(0).scrollHeight,
            self = this;

        // Conetnt Holder
        if (contentHolder.css(&#x27;overflow&#x27;) !== &#x27;hidden&#x27;) {
            ops.originalOverflow = contentHolder.css(&#x27;overflow&#x27;);
            contentHolder.css(&#x27;overflow&#x27;, &#x27;hidden&#x27;);
        }

        // Add plugin class
        self.element.addClass(ops.pluginClassName);

        // Determine whether we need a horizontal and/or vertical scrollbar.
        // Init vertical scrollbar
        if (contentScrollHeight &gt; contentHolder.height()) {
            self.initScrollbar(ops.scrollbarOriented.VERTICALLY);
        }

        // Init horizontal scrollbar or hide it
        if (contentScrollWidth &gt; contentHolder.width()) {
            self.initScrollbar(ops.scrollbarOriented.HORIZONTALLY);
        }
        else {
            self.getUiElement(&#x27;horizScrollbar&#x27;).css(&#x27;display&#x27;, &#x27;none&#x27;);
        }

        // ----------------------------------------------------------
        // Move to an add event listener function (for consistency)
        // ----------------------------------------------------------
        // Bind mousewheel event
        contentHolder.bind(&#x27;mousewheel&#x27;, function (e, delta, deltaX, deltaY) {
//            console.log(&#x27;delta: &#x27;, delta, &#x27;x: &#x27;, deltaX, &#x27;y: &#x27;, deltaY);

            var mimickBrowser = self.getValueFromOptions(&#x27;mimickBrowser&#x27;),
                scrollSpeed, incrementer;

            // If not mimick browser scrollbars stop propagation and
            // prevent default behaviour
            if (!mimickBrowser) {
                // Scroll this element individually
                e.preventDefault();

                // Stop propagation for nested scroll panes
                e.stopPropagation();
            }

            delta = isset(delta) ? delta :
                (isset(deltaX)? deltaX : deltaY);

            // Prelims
            scrollSpeed = self.getValueFromOptions(&#x27;scrollSpeed&#x27;);
            incrementer = delta &lt; 1 ?  scrollSpeed : -scrollSpeed;

            // Scroll horizontally
            if (deltaX !== 0 &amp;&amp; deltaY === 0) {
                self.scrollHorizontally(contentHolder.scrollLeft() + incrementer);
                if (mimickBrowser
                    &amp;&amp; contentHolder.scrollLeft() !== 0
                    &amp;&amp; contentHolder.scrollLeft() !== contentHolder.get(0).scrollWidth) {
                    // Scroll this element individually
                    e.preventDefault();

                    // Stop propagation for nested scroll panes
                    e.stopPropagation();
                }
            }
            // Assume vertical scrolling action
            else if (deltaX === 0 &amp;&amp; deltaY !== 0) {
                self.scrollVertically(contentHolder.scrollTop() + incrementer);
                if (mimickBrowser
                    &amp;&amp;contentHolder.scrollTop() !== 0
                    &amp;&amp; contentHolder.scrollTop() !== contentHolder.get(0).scrollHeight - 1) {
                    // Scroll this element individually
                    e.preventDefault();
                    // Stop propagation for nested scroll panes
                    e.stopPropagation();
                }
            }
        });

        // Get mouse position tracker
        ops.mousePos = $(window).juiMouse();

        // Listen for arrow keys
        $(window).bind(&#x27;keydown&#x27;, function (e) {

            var incrementer,
                keyCode = e.keyCode + &#x27;&#x27;;

            // If not arrow key pressed
            if (!ops.keyPressHash.hasOwnProperty(keyCode)) {
                return;
            }

            // If mouse not within scrollpane elm, bail
            if (!ops.mousePos.juiMouse(&#x27;hitTest&#x27;, contentHolder)) {
                return;
            }

            // Set focus on scrollpane
            contentHolder.focus();

            // Stop outer elemnt from scrolling
            e.preventDefault();

            incrementer = self.getValueFromOptions(&#x27;scrollSpeed&#x27;) *
                ops.keyPressHash[keyCode];

            // Get mouse position
            switch (keyCode) {
                // Left
                case &#x27;37&#x27;:
                    self.scrollHorizontally(incrementer + contentHolder.scrollLeft());
                    break;
                case &#x27;38&#x27;:
                    self.scrollVertically(incrementer + contentHolder.scrollTop());
                    break;
                case &#x27;39&#x27;:
                    self.scrollHorizontally(incrementer + contentHolder.scrollLeft());
                    break;
                case &#x27;40&#x27;:
                    self.scrollVertically(incrementer + contentHolder.scrollTop());
                break;
            }
        });
        // ----------------------------------------------------------
        // End of move to add event listener function
        // ----------------------------------------------------------
    },

    _scrollByOrientation: function (value, orientation) {
        var ops = this.options,
            contentHolder = this.getUiElement(&#x27;contentHolder&#x27;),
            layout = orientation,
            vars = this.getScrollDirVars(layout),
            scrollTotal = vars.scrollAmountTotal,
            handle = this.getScrollbarHandleByOrientation(layout),
            scrollbar = this.getScrollbarByOrientation(layout),
            scrollPercent,
            dir = vars.cssCalcDir,
            dimProp = &#x27;outer&#x27; + ucaseFirst(vars.scrollbarDimProp);

        // If not scrollable bail
        if (contentHolder[vars.scrollbarDimProp]() &gt;= scrollTotal) {
            return;
        }

        if (value &lt;= scrollTotal &amp;&amp; value &gt;= 0) {
            contentHolder[&#x27;scroll&#x27; + ucaseFirst(dir)](value);
            scrollPercent = value / scrollTotal;
            handle.css(dir, scrollbar[dimProp]() * scrollPercent);
        }
        else if (value &gt; scrollTotal) {
            handle.css(dir, scrollbar[dimProp]() - handle[dimProp]());
        }
        else if (value &lt; 0) {
            handle.css(dir, 0);
        }
        this.scrollContentHolder(layout);
        this.constrainHandle(layout);
    },

    scrollContentHolder: function (oriented) {
        // Calculate percent of scroll action
        var handle = this.getScrollbarHandleByOrientation(oriented),
            scrollbar = this.getScrollbarByOrientation(oriented),
            contentHolder = this.getUiElement(&#x27;contentHolder&#x27;),

        // Scroll vars
            scrollVars = this.getScrollDirVars(oriented),
            scrollAmountTotal = scrollVars.scrollAmountTotal,
            dir = scrollVars.cssCalcDir,
            dimProp = scrollVars.scrollbarDimProp,

        // Math
            percentScroll = handle.position()[dir] / scrollbar[dimProp](),
            scrollPos = percentScroll * scrollAmountTotal,
            contentHolderScrollFunc = &#x27;scroll&#x27; + ucaseFirst(dir);

        // Scroll only if limits haven&#x27;t been reached
        if (scrollPos &gt;= 0 &amp;&amp; scrollPos &lt;= scrollAmountTotal) {
            contentHolder[contentHolderScrollFunc]
                (percentScroll * scrollAmountTotal);
        }

        // Constrain scroll limits
        else if (scrollPos &lt; 0) {
            contentHolder[contentHolderScrollFunc](0);
        }
        else if (scrollPos &gt; scrollAmountTotal) {
            contentHolder[contentHolderScrollFunc]
                (scrollAmountTotal);
        }
    },

    constrainHandle: function (oriented) {
        var handle = this.getScrollbarHandleByOrientation(oriented),
            scrollbar = this.getScrollbarByOrientation(oriented),
            vars = this.getScrollDirVars(oriented),
            dimProp = vars.scrollbarDimProp,
            dir = vars.cssCalcDir;

        // Limit handle position within scroll bar
        if (handle.position()[dir] &lt; 0) {
            handle.css(dir, 0);
        }
        else if (handle.position()[dir]
            + handle[dimProp]() &gt; scrollbar[dimProp]()) {
            handle.css(dir, scrollbar[dimProp]() - handle[dimProp]());
        }
    },

    initScrollbar: function (oriented) {
        var scrollbar = this.getScrollbarByOrientation(oriented),
            handle = this.getScrollbarHandleByOrientation(oriented),
            contentHolder = this.getUiElement(&#x27;contentHolder&#x27;),
            ops = this.options,
            plugin = this,

        // Resolve scrollbar direction variables
            scrollVars = plugin.getScrollDirVars(oriented),
            dragAxis = scrollVars.dragAxis,
            dir = scrollVars.cssCalcDir,
            dimProp = scrollVars.scrollbarDimProp;

        // Resize handle
        plugin.initScrollbarHandle(oriented);

        // Make draggable handle on scrollbar
        handle.draggable({
            containment: &#x27;parent&#x27;,
            cursor: &#x27;s-resize&#x27;,
            axis: dragAxis,
            drag: function (e, ui) {
                var percentScroll =
                    ui.position[dir] / scrollbar[dimProp]();

                contentHolder[&#x27;scroll&#x27; + ucaseFirst(dir)]
                    (percentScroll * scrollVars.scrollAmountTotal);
            }
        });

        // On Scroll bar click
        scrollbar.bind(&#x27;click&#x27;, function (e) {
            e.stopPropagation();
            handle.css(dir, e[&#x27;offset&#x27; + dragAxis.toUpperCase()]
                - handle[dimProp]() / 2);

            plugin.constrainHandle(oriented);
            plugin.scrollContentHolder(oriented);
        });
    },

    initScrollbarHandle: function (oriented) {
        var contentHolder = this.getUiElement(&#x27;contentHolder&#x27;),
            scrollBar = this.getScrollbarByOrientation(oriented),
            handle = this.getScrollbarHandleByOrientation(oriented),
            vars = this.getScrollDirVars(oriented),
            dimProp = vars.scrollbarDimProp,
            contentDimVal = contentHolder[dimProp](),
            scrollTotal = contentHolder.get(0)[&#x27;scroll&#x27;
                + ucaseFirst(dimProp)],
            scrollbarDimVal = scrollBar[dimProp]();
        handle[dimProp]
            ((contentDimVal * scrollbarDimVal) / scrollTotal);
    },

    getScrollDirVars: function (oriented) {
        var plugin = this,
            ops = plugin.options,
            contentHolder = this.getUiElement(&#x27;contentHolder&#x27;),
            retVal;

        // Resolve scrollbar direction variables
        if (oriented === plugin.options.scrollbarOriented.VERTICALLY) {
            retVal = {
                dragAxis: &#x27;y&#x27;,
                cssCalcDir: &#x27;top&#x27;,
                scrollbarDimProp: &#x27;height&#x27;,
                scrollAmountTotal: contentHolder.get(0).scrollHeight
            }
        }
        else {
            retVal = {
                dragAxis: &#x27;x&#x27;,
                cssCalcDir: &#x27;left&#x27;,
                scrollbarDimProp: &#x27;width&#x27;,
                scrollAmountTotal: contentHolder.get(0).scrollWidth
            }
        }

        return retVal;
    },

    getScrollbarByOrientation: function (oriented) {
        var ops = this.options;
        return oriented === ops.scrollbarOriented.VERTICALLY ?
            this.getUiElement(&#x27;vertScrollbar&#x27;) : this.getUiElement(&#x27;horizScrollbar&#x27;);
    },

    getScrollbarHandleByOrientation: function (oriented) {
        var ops = this.options;
        return oriented === ops.scrollbarOriented.VERTICALLY ?
            this.getUiElement(&#x27;vertHandle&#x27;) : this.getUiElement(&#x27;horizHandle&#x27;);
    },

    scrollVertically: function (value) {
        this._scrollByOrientation(value,
            this.options.scrollbarOriented.VERTICALLY);
    },

    scrollHorizontally: function (value) {
        this._scrollByOrientation(value,
            this.options.scrollbarOriented.HORIZONTALLY);
    },

    _destroy: function () {
        var self = this,
            ops = self.options;

        // Undo original element manipulations
        self.element.attr(&#x27;overflow&#x27;, ops.originalOverflow);

        // Unbind keydown event
        $(window).unbind(&#x27;keydown&#x27;);

        // Remove created elements
        self._removeCreatedElements();

        // Remove plugin class name
        self.element.removeClass(ops.pluginClassName);

        // Unbind mousewheel event and scroll (left, right) to position 0
        self.getUiElement(&#x27;contentHolder&#x27;).unbind(&#x27;mousewheel&#x27;)
            .scrollLeft(0).scrollTop(0);

        // Call jquery.ui.widget&#x27;s _destroy method
        this._super();
    }

});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
